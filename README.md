# 비트코인 가격 예측 및 트레이딩 전략 프로젝트

> PyTorch를 활용한 딥러닝 모델로 비트코인 가격 방향을 예측하고, 이를 기반으로 한 트레이딩 전략의 수익성을 분석합니다.

---

## 📋 프로젝트 목표

- **딥러닝 모델 개발**: 시계열 데이터를 학습하여 다음 날의 비트코인 가격 상승/하락을 예측하는 분류 모델(GRU)을 개발합니다.
- **트레이딩 전략 수립**: 모델의 예측을 기반으로 트레이딩 전략을 적용하고 수익성을 검증합니다.
- **성과 분석**: 개발한 전략의 수익률을 전통적인 'Buy and Hold' 벤치마크 전략과 비교하여 분석합니다.

---

## 🔧 실행 방법

### 1. 환경 준비

- Python 3.8+
- Git

### 2. 저장소 복제 및 종속성 설치

```bash
# 1. 이 GitHub 저장소를 복제(clone)합니다.
git clone <YOUR_REPOSITORY_URL>
cd <REPOSITORY_DIRECTORY>

# 2. 필요한 라이브러리를 설치합니다.
# 가상환경 생성을 권장합니다.
# python -m venv venv
# source venv/bin/activate 
pip install -r requirements.txt
```

### 3. 스크립트 실행

프로젝트의 모든 과정은 `run_experiment.py` 스크립트 실행을 통해 재현할 수 있습니다.

```bash
python run_experiment.py
```

스크립트를 실행하면 데이터 로딩, 모델 학습, 시뮬레이션, 결과 시각화까지의 전 과정이 자동으로 진행됩니다.

---

## 📂 프로젝트 구조

- **`run_experiment.py`**: 데이터 처리, 모델 설계, 학습, 시뮬레이션 및 결과 분석을 포함하는 메인 스크립트 **(핵심 파일)**
- **`utils.py`**: 데이터 로딩, 피처 생성, 모델 클래스 등 유용한 함수들이 정의된 헬퍼 스크립트
- **`assignment_notebook.ipynb`**: 초기 과제 가이드라인을 포함한 주피터 노트북
- **`requirements.txt`**: 프로젝트 실행에 필요한 Python 패키지 목록
- `lab_notebook.ipynb`, `solution.ipynb`: 실습 및 솔루션 참고용 노트북


---

## 📈 모델 및 전략 설계

### 1. 데이터 처리

- **데이터 소스**: `yfinance` 라이브러리를 통해 2020년 1월 1일부터 현재까지의 비트코인(BTC-USD) 일봉 데이터를 사용합니다.
- **피처 엔지니어링**:
  - **기술적 지표**: 이동평균(MA), 변동성, RSI, MACD 등 다양한 기술적 지표를 피처로 추가하여 시장의 모멘텀과 추세를 모델이 학습하도록 합니다.
  - **과거 수익률**: 과거 1일부터 10일까지의 수익률(Lagged Returns)을 포함하여 최근 가격 변화 패턴을 반영합니다.
- **데이터 정규화**: `StandardScaler`를 사용하여 각 피처의 스케일을 통일하고, 모델 학습이 안정적으로 이루어지도록 합니다.
- **시퀀스 데이터 생성**: 딥러닝 모델(GRU)의 입력에 맞게 과거 30일치 데이터를 하나의 시퀀스로 묶어 사용합니다.

### 2. 딥러닝 모델 (GRUModel)

- **아키텍처**: **GRU (Gated Recurrent Unit)** 기반의 모델을 사용했습니다.
  - **선택 이유**: GRU는 LSTM보다 구조가 간단하고 파라미터가 적어 계산 효율성이 높으면서도, 시계열 데이터의 장기 의존성을 효과적으로 학습할 수 있는 모델입니다.
- **구조**:
  1.  **입력층**: 30일치 시퀀스 데이터
  2.  **은닉층**:
      -   2개의 GRU 레이어를 중첩하여 시간의 흐름에 따른 복잡한 패턴을 학습합니다.
      -   `Dropout`과 `BatchNorm1d`을 각 레이어 이후에 적용하여 과적합을 방지하고 학습을 안정화합니다.
  3.  **출력층**:
      -   `Fully Connected Layer`를 거쳐 최종 예측을 수행합니다.
      -   `Sigmoid` 활성화 함수를 통해 결과값을 **가격 상승 확률 (0~1)**로 변환합니다.

### 3. 트레이딩 전략

- **전략**: **단순 매수/매도 전략 (Simple Buy/Sell Strategy)**
  - 모델이 다음 날 가격이 상승할 것(1)으로 예측하면, 보유 현금 전액으로 비트코인을 매수합니다.
  - 모델이 하락할 것(0)으로 예측하면, 보유한 비트코인 전량을 매도합니다.
  - 이 전략은 `utils.py`의 `simulate_trading_strategy` 함수에 `strategy_type='simple'`로 구현되어 있습니다.

---

## 📊 결과 분석

> **참고**: 아래 결과는 **2025-12-19**에 실행된 실제 결과입니다. 실행 시점의 데이터에 따라 결과는 달라질 수 있습니다.

실행 결과, 모델의 예측 성능과 그에 따른 트레이딩 전략의 수익률은 다음과 같습니다.

### 1. 모델 성능 평가

| Metric    | Score  | 분석                                   |
| :-------- | :----- | :------------------------------------- |
| **Accuracy**  | 0.5038 | 약 50%로, 거의 무작위 예측 수준입니다.       |
| **Precision** | 0.5185 | 상승 예측 중 절반 정도만 맞췄습니다.         |
| **Recall**    | 0.0707 | 실제 상승한 경우를 거의 감지하지 못했습니다. |
| **F1 Score**  | 0.1244 | 전반적으로 모델의 예측 성능이 매우 낮습니다. |

모델의 F1 Score가 매우 낮게 나타나, 현재 모델은 유의미한 예측을 하지 못하는 것으로 판단됩니다.

### 2. 트레이딩 전략 수익률 비교

| Strategy           | Initial Capital | Final Value | Total Return (%) |
| :----------------- | :-------------- | :---------- | :--------------- |
| **GRU Model Strategy** | $10,000.00      | $9,531.77   | **-4.68%**       |
| **Buy and Hold**       | $10,000.00      | $9,493.49   | **-5.07%**       |

- **분석**:
  - 두 전략 모두 테스트 기간 동안 손실을 기록했습니다.
  - 하지만 직접 개발한 **GRU 모델 기반 전략(-4.68%)**이 단순히 자산을 보유만 하는 **Buy and Hold 전략(-5.07%)**에 비해 **손실을 0.39%p 방어**하는 데 성공했습니다.
  - 이는 모델이 완벽하지는 않지만, 하락장에서 불필요한 포지션 보유를 일부 회피하여 미세하게나마 위험을 관리했음을 시사합니다.
  - 그러나, 모델의 낮은 예측 성능(F1 Score: 0.12)을 고려할 때 이 결과가 항상 재현될 것이라 신뢰하기는 어렵습니다.

결론적으로, 현재 모델은 수익 창출에는 실패했지만 벤치마크 대비 손실을 줄이는 가능성을 보여주었습니다.

## 💡 개선 방향

1.  **피처 추가**: 소셜 미디어 데이터, 거시 경제 지표 등 비정형 데이터를 추가하여 시장 심리를 반영하면 모델 성능을 높일 수 있습니다.
2.  **모델 고도화**: Attention 메커니즘을 GRU 모델에 결합하여, 가격 예측에 더 중요한 영향을 미치는 특정 시점에 가중치를 부여하는 방식으로 예측 정확도를 개선할 수 있습니다.
3.  **전략 최적화**: 기술적 지표(예: RSI)를 트레이딩 전략에 통합하여, 모델의 예측과 별개로 시장이 과매수/과매도 상태일 때 포지션을 보수적으로 조정하는 복합 전략을 구현할 수 있습니다.
