# 비트코인 가격 예측 및 트레이딩 전략 프로젝트

> PyTorch를 활용한 딥러닝 모델로 비트코인 가격 방향을 예측하고, 이를 기반으로 한 트레이딩 전략의 수익성을 분석합니다.

---

## 📋 프로젝트 목표

- **딥러닝 모델 개발**: 시계열 데이터를 학습하여 다음 날의 비트코인 가격 상승/하락을 예측하는 분류 모델(GRU)을 개발합니다.
- **트레이딩 전략 수립**: 모델이 예측한 '상승 확률'을 이용하여 투자 비중을 조절하는 동적 트레이딩 전략을 적용합니다.
- **성과 분석**: 개발한 전략의 수익률을 전통적인 'Buy and Hold' 벤치마크 전략과 비교하여 초과 수익 달성 여부를 검증합니다.

---

## 🔧 실행 방법

### 1. 환경 준비

- Python 3.8 이상
- Git

### 2. 저장소 복제 및 종속성 설치

```bash
# 1. 이 GitHub 저장소를 복제(clone)합니다.
git clone <YOUR_REPOSITORY_URL>
cd <REPOSITORY_DIRECTORY>

# 2. 필요한 라이브러리를 설치합니다.
pip install -r requirements.txt
```

### 3. 주피터 노트북 실행

프로젝트의 모든 과정은 `assignment_notebook.ipynb` 파일에 포함되어 있습니다.

```bash
jupyter notebook assignment_notebook.ipynb
```

노트북을 실행하고, **"처음부터 끝까지 모든 셀 실행"**을 통해 데이터 로딩, 모델 학습, 시뮬레이션, 결과 시각화까지의 전 과정을 재현할 수 있습니다.

---

## 📂 프로젝트 구조

- **`assignment_notebook.ipynb`**: 데이터 처리, 모델 설계, 학습, 시뮬레이션 및 결과 분석을 포함하는 메인 노트북 **(핵심 파일)**
- **`lab_notebook.ipynb`**: 실습 내용을 담은 참고용 노트북
- **`solution.ipynb`**: 솔루션 예시 노트북
- **`utils.py`**: 데이터 로딩, 피처 생성 등 유용한 함수들이 정의된 헬퍼 스크립트
- **`requirements.txt`**: 프로젝트 실행에 필요한 Python 패키지 목록

---

## 📈 모델 및 전략 설계

### 1. 데이터 처리

- **데이터 소스**: `yfinance` 라이브러리를 통해 2020년 1월 1일부터 현재까지의 비트코인(BTC-USD) 일봉 데이터를 사용합니다.
- **피처 엔지니어링**:
  - **기술적 지표**: 이동평균(MA), 변동성, RSI, MACD 등 다양한 기술적 지표를 피처로 추가하여 시장의 모멘텀과 추세를 모델이 학습하도록 합니다.
  - **과거 수익률**: 과거 1일부터 10일까지의 수익률(Lagged Returns)을 포함하여 최근 가격 변화 패턴을 반영합니다.
- **데이터 정규화**: `StandardScaler`를 사용하여 각 피처의 스케일을 통일하고, 모델 학습이 안정적으로 이루어지도록 합니다.
- **시퀀스 데이터 생성**: 딥러닝 모델(GRU)의 입력에 맞게 과거 30일치 데이터를 하나의 시퀀스로 묶어 사용합니다.

### 2. 딥러닝 모델 (MyTradingModel)

- **아키텍처**: **양방향 GRU (Bidirectional GRU)** 기반의 모델을 설계했습니다.
  - **선택 이유**: GRU는 LSTM보다 구조가 간단하고 파라미터가 적어 계산 효율성이 높으면서도, 시계열 데이터의 장기 의존성을 효과적으로 학습할 수 있습니다. 양방향(Bidirectional) 특성을 추가하여 과거 데이터(역방향)와 미래 데이터(정방향)의 문맥을 모두 고려함으로써 예측 정확도를 높이고자 했습니다.
- **구조**:
  1.  **입력층**: 30일치 시퀀스 데이터
  2.  **은닉층**:
      -   2개의 양방향 GRU 레이어를 중첩하여 복잡한 시계열 패턴을 학습합니다.
      -   `Dropout`과 `BatchNorm1d`을 각 레이어 이후에 적용하여 과적합을 방지하고 학습을 안정화합니다.
  3.  **출력층**:
      -   `Fully Connected Layer`를 거쳐 최종 예측을 수행합니다.
      -   `Sigmoid` 활성화 함수를 통해 결과값을 **가격 상승 확률 (0~1)**로 변환합니다.

### 3. 트레이딩 전략

- **전략**: **확률 기반 포지션 조절 (Probability-based Position Sizing)**
  - 모델이 예측한 상승 확률이 **60% 이상(`threshold=0.6`)**일 경우에만 매수를 고려합니다.
  - 투자 비중은 예측된 확률에 비례합니다. (예: 상승 확률 75% 예측 시, 자본의 75%를 투자)
  - 예측 확률이 임계값 미만이면, 보유 중인 포지션을 모두 매도하여 리스크를 관리합니다.
- **주요 파라미터**:
  - `threshold = 0.6`: 불확실한 예측(상승 확률 50-60%)에 대한 거래를 줄여, 보다 신뢰도 높은 신호에만 반응하도록 설정했습니다.
  - `position_scaling = True`: 예측 확신도에 따라 투자 규모를 조절하여 위험을 동적으로 관리합니다.

---

## 📊 결과 분석

> **참고**: 아래 결과는 특정 시점에 실행된 예시이며, 노트북을 직접 실행할 때마다 최신 데이터에 따라 결과가 달라질 수 있습니다.

- **`My Model` (GRU 기반)** 전략은 `Buy and Hold` 벤치마크 및 `Example Model` (LSTM) 대비 **더 높은 수익률**을 기록하는 경향을 보였습니다.
- 이는 양방향 GRU 아키텍처가 시계열 데이터의 패턴을 더 효과적으로 학습하고, 보수적으로 설정된 `threshold(0.6)`가 불필요한 거래를 줄여 수수료 비용을 절감했기 때문으로 분석됩니다.
- 상세한 포트폴리오 가치 변화 그래프와 최종 수익률 비교 막대그래프는 `assignment_notebook.ipynb`에서 확인할 수 있습니다.

## 💡 개선 방향

1.  **피처 추가**: 소셜 미디어 데이터, 거시 경제 지표 등 비정형 데이터를 추가하여 시장 심리를 반영하면 모델 성능을 높일 수 있습니다.
2.  **모델 고도화**: Attention 메커니즘을 GRU 모델에 결합하여, 가격 예측에 더 중요한 영향을 미치는 특정 시점에 가중치를 부여하는 방식으로 예측 정확도를 개선할 수 있습니다.
3.  **전략 최적화**: 기술적 지표(예: RSI)를 트레이딩 전략에 통합하여, 모델의 예측과 별개로 시장이 과매수/과매도 상태일 때 포지션을 보수적으로 조정하는 복합 전략을 구현할 수 있습니다.
